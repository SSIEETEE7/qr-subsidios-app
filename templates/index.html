<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mercados que renacen: Puebla Vive</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    const mercadosPorMunicipio = {{ mercados|tojson }};
    function actualizarMercados() {
      const municipio = document.getElementById('municipio').value;
      const mercadoSelect = document.getElementById('mercado');
      mercadoSelect.innerHTML = '<option value="">Selecciona un mercado</option>';
      if (mercadosPorMunicipio[municipio]) {
        mercadosPorMunicipio[municipio].forEach(m => {
          const opt = document.createElement('option');
          opt.value = m;
          opt.textContent = m;
          mercadoSelect.appendChild(opt);
        });
      }
    }
  </script>
</head>
<body>

  <section class="pantalla-completa" style="background-image: url('{{ url_for('static', filename='img/hero_mercado.jpg') }}');">
    <div class="contenido-principal">
      <img src="{{ url_for('static', filename='img/logo_puebla.png') }}" class="logo-grande" alt="Logo Gobierno Puebla">
      <h1>Mercados que renacen<br><span style="font-weight: 400;">Puebla Vive</span></h1>

      <div class="botones-rapidos">
        <a href="{{ url_for('catalogo') }}"><img src="{{ url_for('static', filename='img/icono_catalogo.png') }}"><span>Cat√°logo</span></a>
        <a href="{{ url_for('usar_qr') }}"><img src="{{ url_for('static', filename='img/icono_qr.png') }}"><span>QR</span></a>
        <a href="{{ url_for('carrito') }}"><img src="{{ url_for('static', filename='img/icono_carrito.png') }}"><span>Carrito</span></a>
        <a href="{{ url_for('registro_locatarios') }}"><img src="{{ url_for('static', filename='img/icono_locatario.png') }}"><span>Registro</span></a>
      </div>

      <form method="POST" action="{{ url_for('mercados_view') }}" class="selector">
        <select id="municipio" name="municipio" onchange="actualizarMercados()" required>
          <option value="">Selecciona un municipio</option>
          {% for municipio in mercados.keys() %}
            <option value="{{ municipio }}">{{ municipio }}</option>
          {% endfor %}
        </select>

        <select id="mercado" name="mercado" required>
          <option value="">Selecciona un mercado</option>
        </select>

        <button type="submit">Ver productos</button>
      </form>
    </div>
  </section>

</body>
</html>
